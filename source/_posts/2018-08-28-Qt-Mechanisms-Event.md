---
title: Qt从0到1之机制篇 - 事件
author: 张帆
tags:
  - Qt
  - Qt从0到1
  - Qt机制
date: 2018-08-28 17:31:45
---

相信大家在初学C/C++等编程语言时，编写的都是在命令行下运行的程序，也就是运行时只用一个黑框的应用程序。和我们日常使用的GUI程序相比，这些程序除了没有一个GUI界面外，还有一个很大的区别在于这些程序是一种过程式的执行方式，执行完一行代码后再去执行下一句，执行完一个函数再去执行下一个，执行完之后程序就退出了，类似于一个批处理或脚本程序，而GUI程序是可以根据内部或外部的输入来确定执行哪些代码，以什么样的顺序去执行。这些输入可能是系统的分辨率进行了修改，或者是用户点击了一个按钮，按下了键盘上的某个键，触发了一个定时器等等。程序具体如何运行，是受到这些输入控制的，如果没有任何输入，程序将不执行任何代码。这就是批处理程序设计(`batch programming`)和事件驱动程序设计(`Event-driven programming`)的一个显著差异。
在事件驱动程序设计中，事件是核心要素，一个事件就是一个来自外界的信息输入。接触过Windows编程的人应该会了解过Windows的消息循环机制，这里的消息就类似于事件。Windows程序在收到系统派发的消息后，可以根据消息类型及消息参数的不同，进行不同的处理。例如当我们按下键盘上的`Alt + F4`快捷键后，Windows就会向当前的活动窗口发送一个类型为`WM_CLOSE`的消息，这个消息一般用于通过窗口进行关闭。窗口在收到这个消息后，原则上需要将自己关闭，但也可以选择忽略这个消息，这样我们的快捷键就“失效”了。

## Qt事件分发

由于不同的操作系统提供了不同的消息机制，消息类型差异较大，因此Qt为了更好的跨平台性，对常见的通用的消息进行了封装。Qt在收到操作系统发送过来的消息后，会将这些消息封装成Qt事件。然后将这些事件进行分发，直到事件被主动接受、忽略或没有被任何节点处理而被丢弃。
![Qt事件分发]()
所有的Qt事件都是继承于`QEvent`，



